---
title: "Uncovering the Keys to being a Great Artist"
author: "Shahbaz Abdullah Magsi & Elise Deleon"
output: slidy_presentation
date: "2023-11-06"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE)
```

---

# Importing Libraries

```{r}
library(readr)
library(dplyr)
library(ggplot2)
library(gridExtra)
library(scales)
```

- readr: This is typically used for fast data reading, but in our project, base R's read.csv() is actually used for data import.
- dplyr: We used this for data manipulation, such as calculating the number of songs per artist and organizing the data for analysis.
- ggplot2: We used this for creating visualizations to display the artist counts and streaming trends of the songs.
- gridExtra: We utilized this for arranging multiple ggplot2 visualizations in a single, organized grid for comparison.
- scales: We used this to format numerical data in our visualizations for better legibility and aesthetic presentation.

---

```{r}
data <- read.csv("spotify-2023.csv")
```

Data extracted from: 
Most Streamed Spotify Songs 2023
Nidula Elgiriyewithhana
July 2023
https://www.kaggle.com/datasets/nelgiriyewithana/top-spotify-songs-2023/data

![](https://www.scotsman.com/jpim-static/image/2023/11/24/10/12/Spotify%20Wrapped.jpg?trim=0,0,0,0&width=640&quality=65)
---

---

In the digital heartbeat of music, Spotify plays a pivotal role. Our project delves into the Top Artist's remarkable resonance on the platform, seeking to understand the rhythm behind their songs' popularity.

**Our Approach:**
By tapping into Spotify's rich data, we explore the melody of the top artist's success, examining how their music's characteristics harmonize with listener preferences.

**Methodology:**
With user-friendly graphs and visual storytelling, we uncover patterns that reveal why the top artist's tunes often top the charts.

**Insight and Impact:**
For music insiders and fans alike (like us), our analysis offers a concise, data-driven narrative of what makes an artist stand out in the era of streaming.

---



```{r}
head(data)
```

```{r}
artist_counts <- data %>%
  group_by(artist.s._name) %>%
  summarise(num_songs = n()) %>%
  arrange(desc(num_songs))

top_artists <- head(artist_counts, 10)

print(top_artists)
```
```{r}
artist_counts <- data %>%
  group_by(artist.s._name) %>%
  summarise(num_songs = n()) %>%
  arrange(desc(num_songs))

top_artists <- head(artist_counts, 10)

ggplot(top_artists, aes(x = reorder(artist.s._name, -num_songs), y = num_songs, fill = artist.s._name)) +
  geom_col() +
  geom_text(aes(label = num_songs), position = position_stack(vjust = 0.5), size = 3, color = 'black') +
  theme_minimal() +
  labs(x = 'Artist(s) Name', y = 'Number of Songs', title = 'Top 10 Artists with Most Songs') +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
![](https://www.billboard.com/wp-content/uploads/2022/11/taylor-swift-21-savage-drake-billboard-1548.jpg?w=942&h=623&crop=1)


```{r}
selected_artists <- c("Taylor Swift", "Drake, 21 Savage")
selected_data <- data %>% filter(artist.s._name %in% selected_artists)

ranked_data <- selected_data %>%
  group_by(artist.s._name) %>%
  arrange(desc(streams)) %>%
  mutate(rank = row_number()) %>%
  filter(rank <= 5)

ggplot(ranked_data, aes(x = reorder(track_name, streams), y = streams, fill = artist.s._name)) +
  geom_col(position = "dodge") +
  theme_minimal() +
  labs(x = 'Song Name', y = 'Stream Count', title = 'Top 5 Streamed Songs Comparison') +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
selected_data <- data %>% filter(artist.s._name %in% c("Taylor Swift", "Drake, 21 Savage"))

selected_data$streams <- as.numeric(selected_data$streams)

most_streamed_taylor <- selected_data %>%
  filter(artist.s._name == "Taylor Swift") %>%
  arrange(desc(streams)) %>%
  slice_head(n = 1)

most_streamed_drake_21savage <- selected_data %>%
  filter(artist.s._name == "Drake, 21 Savage") %>%
  arrange(desc(streams)) %>%
  slice_head(n = 1)

combined_most_streamed <- bind_rows(most_streamed_taylor, most_streamed_drake_21savage)

total_streams <- sum(combined_most_streamed$streams)

combined_most_streamed <- combined_most_streamed %>%
  mutate(percentage = streams / total_streams * 100)

ggplot(combined_most_streamed, aes(x = "", y = percentage, fill = artist.s._name)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y") +
  theme_void() +
  labs(title = "Most Streamed Songs", fill = "Artist") +
  scale_fill_manual(values = c("Taylor Swift" = "light pink", "Drake, 21 Savage" = "light blue")) +
  theme(legend.position = "bottom") +
  guides(fill = guide_legend(ncol = 2, title.position = "top", title.hjust = 0.5)) +
  geom_text(aes(label = paste0(track_name, "\n", round(percentage, 1), "%")),
            position = position_stack(vjust = 0.5))
```


```{r}
taylor_swift_data <- data %>%
  filter(artist.s._name == "Taylor Swift")

head(taylor_swift_data)
```

```{r}
drake_21_data <- data %>%
  filter(artist.s._name == "Drake, 21 Savage")

head(drake_21_data)
```
```{r}
plot_taylor_swift <- ggplot(taylor_swift_data, aes(x = factor(released_month, levels = 1:12, labels = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")))) +
  geom_bar(fill = "skyblue") +
  geom_text(stat = 'count', aes(label = ..count..), vjust = -0.5) +
  labs(title = "Taylor Swift Song Releases",
       x = "Month",
       y = "Number of Songs Released") +
  theme_minimal()

plot_drake_21 <- ggplot(drake_21_data, aes(x = factor(released_month, levels = 1:12, labels = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")))) +
  geom_bar(fill = "lightgreen", width = 0.3) + 
  geom_text(stat = 'count', aes(label = ..count..), vjust = -0.5, position = position_dodge(width = 0.5)) +
  labs(title = "Drake and 21 Savage Song Releases",
       x = "Month",
       y = "Number of Songs Released") +
  theme_minimal()

grid.arrange(plot_taylor_swift, plot_drake_21, ncol = 2)
```


```{r}
taylor_swift_data$streams <- as.numeric(taylor_swift_data$streams)
drake_21_data$streams <- as.numeric(drake_21_data$streams)

ggplot() +
  geom_line(data = taylor_swift_data, aes(x = released_year, y = streams, group = 1, color = "Taylor Swift")) +
  geom_line(data = drake_21_data, aes(x = released_year, y = streams, group = 1, color = "Drake and 21 Savage")) +
  labs(title = "Streams Trend Over Time",
       x = "Year",
       y = "Streams") +
  theme_minimal() +
  scale_color_manual(values = c("Taylor Swift" = "blue", "Drake and 21 Savage" = "red")) +
  scale_y_continuous(labels = scales::comma) # Format y-axis labels

scale_y_continuous(labels = scales::label_number_si()) # Formats numbers to millions (e.g., 1M)

```


```{r}
plot_taylor_swift <- ggplot(taylor_swift_data, aes(x = danceability_., y = streams)) +
  geom_point() +
  labs(title = "Taylor Swift's Songs",
       x = "Danceability",
       y = "Streams") +
  theme_minimal()

plot_drake_21 <- ggplot(drake_21_data, aes(x = danceability_., y = streams)) +
  geom_point() +
  labs(title = "Drake & 21 Savage Songs",
       x = "Danceability",
       y = "Streams") +
  theme_minimal()

grid.arrange(plot_taylor_swift, plot_drake_21, ncol = 2)
```
```{r}
taylor_swift_data$artist <- 'Taylor Swift'
drake_21_data$artist <- 'Drake and 21 Savage'

combined_data <- rbind(taylor_swift_data, drake_21_data)

ggplot(combined_data, aes(x = danceability_., y = valence_., color = artist)) +
  geom_point() +
  labs(title = "Correlation between Valence and Danceability",
       x = "Danceability",
       y = "Valence") +
  theme_minimal() +
  scale_color_manual(values = c("Taylor Swift" = "blue", "Drake and 21 Savage" = "red"))
```
```{r}
plot_taylor_swift <- ggplot(taylor_swift_data, aes(x = energy_., y = streams)) +
  geom_point() +
  labs(title = "Taylor Swift's Songs",
       x = "Energy",
       y = "Streams") +
  theme_minimal()

plot_drake_21 <- ggplot(drake_21_data, aes(x = energy_., y = streams)) +
  geom_point() +
  labs(title = "Drake & 21 Savage Songs",
       x = "Energy",
       y = "Streams") +
  theme_minimal()

grid.arrange(plot_taylor_swift, plot_drake_21, ncol = 2)
```



```{r}
plot_taylor_swift <- ggplot(taylor_swift_data, aes(x = bpm)) +
  geom_histogram(binwidth = 10, fill = "#ADD8E6", color = "black") +
  labs(title = "Taylor Swift's Songs",
       x = "Beats Per Minute (BPM)",
       y = "Frequency") +
  theme_minimal()

plot_drake_21 <- ggplot(drake_21_data, aes(x = bpm)) +
  geom_histogram(binwidth = 10, fill = "#FFC0CB", color = "black") +
  labs(title = "Drake & 21 Savage's Songs",
       x = "Beats Per Minute (BPM)",
       y = "Frequency") +
  theme_minimal()

grid.arrange(plot_taylor_swift, plot_drake_21, ncol = 2)
```

```{r}
correlation <- cor(taylor_swift_data$in_spotify_playlists, taylor_swift_data$streams)

ggplot(taylor_swift_data, aes(x = in_spotify_playlists, y = streams)) +
  geom_point(color = 'blue', alpha = 0.5) +
  labs(x = 'Number of Spotify Playlists', y = 'Total Number of Streams',
       title = paste('Correlation between Spotify Playlists and Streams (Correlation Coefficient:', round(correlation, 2), ')')) +
  theme_minimal()
```
